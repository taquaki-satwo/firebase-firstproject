<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Welcome to Firebase Hosting</title>

  <!-- update the version number as needed -->
  <script defer src="/__/firebase/4.8.1/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/4.8.1/firebase-auth.js"></script>
  <script defer src="/__/firebase/4.8.1/firebase-database.js"></script>
  <script defer src="/__/firebase/4.8.1/firebase-messaging.js"></script>
  <script defer src="/__/firebase/4.8.1/firebase-storage.js"></script>
  <!-- initialize the SDK after all desired features are loaded -->
  <script defer src="/__/firebase/init.js"></script>

  <script src="https://www.gstatic.com/firebasejs/4.8.1/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyAqKiyGKDDt-Leuu_M1QYLWNwheucfcdjI",
      authDomain: "firstproject-1a510.firebaseapp.com",
      databaseURL: "https://firstproject-1a510.firebaseio.com",
      projectId: "firstproject-1a510",
      storageBucket: "firstproject-1a510.appspot.com",
      messagingSenderId: "308948742511"
    };
    firebase.initializeApp(config);
  </script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body>
  <input id="name" type="text" placeholder="ユーザー名を入力してください">
  <button id="btn" type="button">
    <i class="material-icons">&#xE87D;</i>
  </button>
  <p id="info"></p>

  <script>
    var db = firebase.database();
    var $btn = document.getElementById('btn');
    var $info = document.getElementById('info');

    $btn.addEventListener('click', writeUserName, false);

    db.ref('/user/').on('value', function (snapshot) {
      updateInfo(snapshot.val());
    });

    function writeUserName(e) {
      var name = document.getElementById('name').value;
      if (name === '') return false;
      db.ref('/user/').set({
        username: name
      });
    }

    function updateInfo(obj) {
      $info.innerHTML = obj.username + 'さんがお気に入りに登録しました。';
    }
  </script>

</body>

</html>